{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDR,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFf,EAAyBM,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,GAAO,G,+BCL9D,MAAM,EAA+BC,OAAOC,KAAKC,OAAY,I,aCA7D,MAAM,EAA+BF,OAAOC,KAAKC,OAAe,OCA1D,EAA+BF,OAAOC,KAAKC,OAAO,wB,aCAzC,SAASC,EAAgBhB,EAAGiB,GAKzC,OAJAD,EAAkBf,OAAOiB,eAAiBjB,OAAOiB,eAAeC,OAAS,SAAyBnB,EAAGiB,GAEnG,OADAjB,EAAEoB,UAAYH,EACPjB,CACT,EACOgB,EAAgBhB,EAAGiB,EAC5B,CCLe,SAASI,EAAeC,EAAUC,GAC/CD,EAASf,UAAYN,OAAOuB,OAAOD,EAAWhB,WAC9Ce,EAASf,UAAUkB,YAAcH,EACjCJ,EAAeI,EAAUC,EAC3B,CCLA,MAAM,EAA+BV,OAAOC,KAAKC,OAAO,gB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,sB,aCGnCW,EAAO,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAAC,MAAA,KAAAC,YAAA,KAUzB,OAVyBR,EAAAK,EAAAC,GAAAD,EAAAnB,UAQ1BuB,YAAA,WACE,MAAO,qBAAoBC,KAAKC,OAAS,IAAID,KAAKE,KAAKC,GAAO,GAChE,EAACR,CAAA,CAVyB,CAASS,IAAMC,IAAO,CAChDC,QAASD,IAAAA,UAAgB,WACzBE,KAAMF,IAAAA,OAAa,QACnBG,SAAUH,IAAAA,UAAgB,YAC1BI,UAAWJ,IAAAA,UAAgB,YAAaA,IAAAA,eACxCK,aAAcL,IAAAA,OAAa,gBAC3BM,OAAQN,IAAAA,OAAa,aCNFO,EAAY,SAAAhB,GAAA,SAAAgB,IAAA,OAAAhB,EAAAC,MAAA,KAAAC,YAAA,KAU9B,OAV8BR,EAAAsB,EAAAhB,GAAAgB,EAAApC,UAQ/BuB,YAAA,WACE,MAAO,0BAAyBC,KAAKC,OAAS,IAAID,KAAKE,KAAKC,GAAO,GACrE,EAACS,CAAA,CAV8B,CAASR,IAAMC,IAAO,CACrDQ,SAAUR,IAAAA,QAAc,YACxBS,WAAYT,IAAAA,QAAc,cAC1BU,cAAeV,IAAAA,UAAgB,iBAC/BW,OAAQX,IAAAA,UAAgB,UACxBI,UAAWJ,IAAAA,UAAgB,YAAaA,IAAAA,eACxCY,UAAWZ,IAAAA,UAAgB,YAAaA,IAAAA,kBCNrBa,EAAgB,SAAAtB,GAAA,SAAAsB,IAAA,OAAAtB,EAAAC,MAAA,KAAAC,YAAA,YAAAR,EAAA4B,EAAAtB,GAAAsB,CAAA,EAASd,IAAMC,IAAO,CACzDK,aAAcL,IAAAA,OAAa,gBAC3BE,KAAMF,IAAAA,OAAa,QAEnBc,OAAQd,IAAAA,UAAgB,UACxBe,eAAgBf,IAAAA,UAAgB,kBAChCgB,SAAUhB,IAAAA,UAAgB,eCT5B,MAAM,EAA+BvB,OAAOC,KAAKC,OAAO,e,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAc,M,aCA/D,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,0B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,oB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,yB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,2B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,sC,aCEnCsC,EAAW,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAA1B,MAAA,KAAAC,YAAA,KAAAR,EAAAgC,EAAAC,GAAAD,EACvBE,UAAP,SAAiBC,GACfA,EAAMC,UAAYD,EAAMC,WAAa,GACrCD,EAAME,QAAUF,EAAME,SAAW,GACjCF,EAAMG,QAAUH,EAAMG,UAAW,CACnC,EAAC,IAAAC,EAAAP,EAAA9C,UA8BA,OA9BAqD,EAEDC,KAAA,WACE,OAAOC,EAAA,OAAKL,UAAW1B,KAAKyB,MAAMC,WACpC,EAACG,EAEDG,SAAA,SAASC,GAAO,IAAAC,EAAA,KAGd,GAFAX,EAAA/C,UAAMwD,SAAQtD,KAAC,KAAAuD,GAEXjC,KAAKyB,MAAMG,QAAS,CACtB,IAAIA,EACEO,EAAgB,WACpB,IAAMR,EAAUO,EAAKT,MAAME,QAEvBC,IAAYD,IAEhBC,EAAUD,EAEVS,IAAIC,cAAcT,QAAQD,GAAW,GAAIM,EAAMK,KACjD,EACAH,IAEAnC,KAAKuC,eAAiBC,YAAYL,EAAe,GACnD,MACEC,IAAIC,cAAcT,QAAQ5B,KAAKyB,MAAME,QAASM,EAAMK,IAExD,EAACT,EAEDY,SAAA,WACEC,cAAc1C,KAAKuC,eACrB,EAACjB,CAAA,CAnC6B,CAASqB,KCFzC,MAAM,EAA+B7D,OAAOC,KAAKC,OAAO,uB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,yB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,uB,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,a,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,mB,aCanC4D,EAAgB,SAAArB,GAAA,SAAAqB,IAAA,OAAArB,EAAA1B,MAAA,KAAAC,YAAA,KAAAR,EAAAsD,EAAArB,GAAA,IAAAM,EAAAe,EAAApE,UAuYlC,OAvYkCqD,EACnCgB,OAAA,SAAOZ,GAAO,IAAAC,EAAA,KACZlC,KAAK8C,SAAU,EACf9C,KAAKiC,MAAQA,EACbjC,KAAK+C,OAASd,EAAMR,MAAMsB,OAC1B/C,KAAKgD,QAAUjB,EAAEkB,MAAMC,MAAM,MAC7BlD,KAAKmD,WAAY,EAEjBnD,KAAKoD,eAAgB,EAErBpD,KAAKqD,aAAc,EAmBnBrD,KAAKsD,UAAY,WACf,GAAmB,IAAfpB,EAAKqB,MAGP,OAFArB,EAAKmB,aAAc,OACnBtB,EAAEyB,SAGJtB,EAAKqB,QACDrB,EAAKqB,OAAS,GAChBE,YAAW,WACTvB,EAAKoB,WACP,GAAG,IAEP,EA7BkB,SAAZI,IACJxB,EAAKkB,eAAgB,EACrBK,YAAW,WACTC,GACF,GAAG,IACL,CA0BAA,GAxBkB,SAAZC,IACAzB,EAAK0B,WAAa,IAAIC,KAAKA,KAAKC,MAAQ,OAC1C5B,EAAK6B,QAAS,EACdhC,EAAEyB,UAEJC,YAAW,WACTE,GACF,GAAG,IACL,CAiBAA,GAEA3D,KAAK+D,QAAS,EAEd/D,KAAKU,aAAeV,KAAKU,aAAeV,KAAKU,aAAeuB,EAAMR,MAAMf,aAExEV,KAAKgE,UACP,EAACnC,EAEDmC,SAAA,WAOE,OANAhE,KAAKiE,gBAAkB,EAEvBjE,KAAKkE,OAELlE,KAAKmE,eAAiBC,IAAO,IAEtB,IAAIC,SAAQ,WACjBZ,YAAW,WACTa,EAAE,iBAAiBC,QAAQ,CAAEC,UAAWF,EAAE,iBAAiB/F,KAAK,iBAAmB,IACrF,GAAG,IACL,GACF,EAACsD,EAEDY,SAAA,WACMgC,IAAAA,QACFA,IAAAA,OAAWC,MAAK,SAACC,GACf,IAAMC,EAAWD,EAAOC,SACxBA,EAASrE,KAAKsE,OAAO,UACrBD,EAASrE,KAAKsE,OAAO,aACvB,GAEJ,EAAChD,EAEDiD,SAAA,WAAW,IAAAC,EAAA,KACTT,EAAE,iBAAiBU,QAAO,WACxB,IAAKD,EAAK/D,QAEI,IADFsD,EAAE,iBAAiBE,YACd,CACb,IAAMS,EAAWX,EAAE,0BACnBS,EAAKG,YAAYT,IAAAA,MAAU5D,SAASkE,EAAKrE,aAAaP,MAAMgF,QACvDJ,EAAK/D,QACRsD,EAAE,iBAAiBE,UAAUS,EAASG,SAASC,IAEnD,CAEJ,GACF,EAACxD,EAEDyD,eAAA,WAAiB,IAAAC,EAAA,KACfjB,EAAE,iBACCkB,IAAI,SACJC,GAAG,SAAS,SAACC,GACZH,EAAK7E,aAAe+D,IAAAA,MAAUkB,cAAcrB,EAAEoB,EAAEE,eAAeC,KAAK,OACpEN,EAAKO,MAAQxB,EAAEoB,EAAEE,eAAeC,KAAK,MACrCN,EAAKvE,QAAS,EACduE,EAAKQ,OAAS,KACdR,EAAK1C,OAAO0C,EAAKtD,OACjBF,EAAEyB,QACJ,IAEFc,EAAE,oBACCkB,MACAC,GAAG,WAAW,SAACC,GACI,KAAdA,EAAEM,SAAkBvB,IAAAA,MAAUwB,UAAU,sBAC1C3B,EAAE,oBAAoB/F,KAAK,YAAY,GACvCgH,EAAKW,cAET,GACJ,EAACrE,EAEDG,SAAA,WAAW,IAAAmE,EAAA,KACL1B,IAAAA,QACFA,IAAAA,OAAWC,MAAK,SAACC,GACf,IAAMC,EAAWD,EAAOC,SACxBA,EAASrE,KAAKnB,KAAK,cAAc,SAACc,GAChC,GACEkG,SAASlG,EAAKkB,kBAAoBgF,SAASD,EAAKzF,aAAaP,OAC7DmE,EAAE,qBAAqB+B,SAAS,kBAAkBC,GAAG,YACrD,CACA,IAAMhG,EAAU,CACdH,GAAIiE,IAAOlE,EAAKC,IAChBG,QAAS8D,IAAOlE,EAAKI,SACrBC,KAAM6D,IAAO+B,EAAK5F,MAClBE,UAAW2D,IAAOlE,EAAKO,YAEzB0F,EAAKI,gBAAgB,CAACjG,IACtB6F,EAAKlC,kBACLkC,EAAKpC,QAAS,EACdhC,EAAEyB,SACFc,EAAE,iBAAiBC,QAAQ,CAAEC,UAAWF,EAAE,iBAAiB/F,KAAK,iBAAmB,IACrF,CACF,IAEAqG,EAASrE,KAAKnB,KAAK,UAAU,SAACc,GAC5B,GAAIkG,SAASlG,EAAKkB,kBAAoBgF,SAASD,EAAKzF,aAAaP,MAAO,CACtE,IAAIqG,EAAOlC,EAAE,iBAETmC,GAAa,EAEbD,EAAKhC,YAAcgC,EAAKE,eAAiBF,EAAK,GAAGG,aAAe,KAClEF,GAAa,GAGfN,EAAKpC,QAAS,EACdoC,EAAKvC,WAAa,IAAIC,KACtB9B,EAAEyB,SAEEiD,GACFD,EAAKjC,QAAQ,CAAEC,UAAWF,EAAE,iBAAiB/F,KAAK,iBAAmB,IAEzE,CACF,IAEAqG,EAASrE,KAAKnB,KAAK,eAAe,SAACc,GAC7BkG,SAASlG,EAAKkB,kBAAoBgF,SAASD,EAAKzF,aAAaP,QAC/DgG,EAAKS,UAAUvF,SAAWU,EAAExD,KAAK2B,EAAKS,QACtCoB,EAAEyB,SAEN,GACF,GAEJ,EAAC3B,EAEDC,KAAA,WAAO,IAAA+E,EAAA,KAEL,OADA7G,KAAKa,SAAW4D,IAAAA,MAAU5D,SAAW4D,IAAAA,MAAU5D,SAASb,KAAKU,aAAaP,MAAQ,GAEhF4B,EAAA,OAAK+E,MAAO9G,KAAKgD,SAAWhD,KAAK+C,OAAS,cAAgB,GAAIrB,UAAU,QACtEK,EAAA,OAAKL,UAAU,wBACZqF,IAAO/G,KAAKO,MACbwB,EAAA,OAAKL,UAAU,cACbK,EAAA,OAAKL,UAAU,aACfK,EAACiF,IAAI,CAACC,KAAMxC,IAAAA,MAAUlE,KAAKP,KAAKO,OAC/B2G,IAASlH,KAAKO,QAGfwB,EAAA,OAAKL,UAAU,qBACZ+C,IAAAA,WAAe0C,MACd,wCAA0Cf,SAASpG,KAAKU,aAAaK,iBAAmB,EAAI,WAAa,UACzG,CAAEqG,MAAOpH,KAAKU,aAAaK,gBAAkBf,KAAKiE,qBAKzDjE,KAAKa,UAAYb,KAAKa,SAASsE,OAAS,IAAMnF,KAAK8C,QAClD,CACEf,EAAA,OAAKL,UAAU,gBACbK,EAAA,UACG/B,KAAKgB,OAASe,EAAA,MAAIL,UAAU,cAAc+C,IAAAA,WAAe0C,MAAM,qDAA4D,GAC3HnH,KAAKa,SACFb,KAAKa,SACFwG,QAAO,SAAC/G,EAASwF,EAAOwB,GAAI,OAAKxB,IAAUwB,EAAKC,WAAU,SAACC,GAAC,OAAKA,EAAElH,YAAcA,EAAQA,SAAS,GAAC,IACnGmH,MAAK,SAAC5J,EAAG6J,GACR,OAAO7J,EAAE4C,YAAciH,EAAEjH,WAC3B,IACCkH,KAAI,SAACrH,EAASsH,GACb,IAAMC,EAAYzB,SAAS9F,EAAQC,OAAOJ,QAAUiG,SAAS3B,IAAAA,QAAYlE,KAAKJ,MAC9E,OACE4B,EAAA,MAAIL,UAAU,4BACZK,EAAA,OAAKL,UAAW,iBAAmBmG,EAAY,cAAgB,KAC7D9F,EAAA,OAAKL,UAAW,kBAAoBmG,EAAY,KAAO,UACpDd,IAAOc,EAAYpD,IAAAA,QAAYlE,KAAOD,EAAQC,SAEjDwB,EAAA,QAAML,UAAU,qBAAqBwF,IAASW,EAAYpD,IAAAA,QAAYlE,KAAOD,EAAQC,SACrFwB,EAAA,QAAML,UAAU,qBAAqBoG,IAAUxH,EAAQG,eAEzDsB,EAACT,EAAW,CACVK,QAASrB,EAAQA,UACjBoB,UAAW,YAAcmG,EAAY,yBAA2B,mBAEjEA,GACCzB,SAASS,EAAKD,UAAUvF,aAAe+E,SAAS9F,EAAQJ,KAAK6H,WAAWpH,QACtEoB,EAAA,QAAML,UAAU,gBAAgBsG,IAAK,iBAKvC,GAIR,IACF,GACHhI,KAAKmE,iBACJpC,EAAA,UACEA,EAACT,EAAW,CAACK,QAAS3B,KAAKmE,iBAAkBzC,UAAW,iDAAkDE,SAAS,KAGrH,GAED5B,KAAK+D,OACJhC,EAAA,UACEA,EAAA,OAAKL,UAAU,WACbK,EAAA,OAAKL,UAAU,UACfK,EAAA,OAAKL,UAAU,UACfK,EAAA,OAAKL,UAAU,YAInB,MAMRK,EAACkG,IAAgB,CAACC,QAAQ,QAAQC,KAAK,WAGzCpG,EAAA,QAAML,UAAU,yBACdK,EAAA,YACE5B,GAAG,kBACHtB,MAAOmB,KAAKmE,iBACZiE,QAASC,IAAS,QAASrI,KAAKsI,WAAWlJ,KAAKY,OAChDuI,YAAa9D,IAAAA,WAAe0C,MAAM,+CAClCqB,KAAK,MAGNC,IAAAA,UACC,CACEC,QAAS1I,KAAKkG,YAAY9G,KAAKY,MAC/B0B,UAAW,yBACXiH,UAAW3I,KAAKmE,mBAAqBnE,KAAKqD,aAE5CoB,IAAAA,WAAe0C,MAAM,qCAK/B,EAACtF,EAEDyG,WAAA,SAAWzJ,GAAO,IAAA+J,EAAA,KAChB5I,KAAKmE,eAAetF,GACpBkD,EAAEyB,SACExD,KAAKoD,eACPqB,IAAAA,QACW,CACPoE,OAAQ,OACRC,IAAKrE,IAAAA,MAAUwB,UAAU,UAAY,2BACrC8C,KAAM,CACJ3H,eAAgBpB,KAAKU,aAAaP,KAClCgB,OAAQnB,KAAKO,KAAKJ,QAGrBuE,MAAK,WACJkE,EAAKxF,eAAgB,CACvB,GAEN,EAACvB,EAEDqE,YAAA,WAAc,IAAA8C,EAAA,KACZ,GAAIhJ,KAAKqD,YAAa,CACpB,GAA8B,KAA1BrD,KAAKmE,mBAA4BnE,KAAKmE,iBAAiB8E,QAAQ,MAAO,IAAI9D,OAAQ,OACtFnF,KAAKqD,aAAc,EACnBrD,KAAKuD,MAAQ,EACbvD,KAAKsD,YACLtD,KAAKiE,kBACLQ,IAAAA,MACGyE,aAAa,YACbC,KAAK,CACJC,gBAAiBpJ,KAAKmE,iBACtB/C,eAAgBpB,KAAKU,aAAaP,OAEnCuE,MAAK,SAACpE,GACLmE,IAAAA,MAAU5D,SAASmI,EAAKtI,aAAaP,MAAMkJ,KAAK/I,GAChDyB,EAAEyB,SACFwF,EAAK7E,eAAe,IACpBG,EAAE,iBAAiBC,QAAQ,CAAEC,UAAWF,EAAE,iBAAiB/F,KAAK,iBAAmB,KACnFkG,IAAAA,QAAY,CACVoE,OAAQ,OACRC,IAAKrE,IAAAA,MAAUwB,UAAU,UAAY,yBACrC8C,KAAM,CACJ3H,eAAgB4H,EAAKtI,aAAaP,KAClCmJ,UAAWhJ,EAAQH,OAGzB,GACJ,CACF,EAAC0B,EAEDqD,YAAA,SAAYE,GAAY,IAAAmE,EAAA,UAAN,IAANnE,IAAAA,EAAS,GACdpF,KAAKgB,QACRyD,IAAAA,MACG+E,KAAK,mBAAoBxJ,KAAKU,aAAaP,KAAM,CAAEiF,OAAAA,IACnDV,MAAK,SAAC+E,GAAY,IAAAC,EAEjB,UADOD,EAAQE,QACXJ,EAAKpG,UAAW,CAClB,IAAMyG,EAAYL,EAAKM,YAAYxI,WACnCoD,IAAAA,QACW,CACPoE,OAAQ,OACRC,IAAKrE,IAAAA,MAAUwB,UAAU,UAAY,yBACrC8C,KAAM,CACJ3H,eAAgBmI,EAAK7I,aAAaP,KAClCmJ,UAAWG,EAAQ,GAAGtJ,QAGzBuE,MAAK,SAACoF,GACL,IAAMC,EAAYD,EAAS5J,KAAK6H,WAAW1G,SACvC2I,EAAiB,EACfC,EAAoBxF,IAAAA,QAAYlE,KAAKyJ,iBAEjB,IAAtBC,IAAyBD,EAAiBC,GAAqBF,EAAYH,IAE3EI,GAAkB,IACpBvF,IAAAA,QAAYlE,KAAK2J,eAAe,CAC9BF,eAAAA,IAGFjI,EAAEyB,UAGJ+F,EAAKpG,WAAY,CACnB,GACJ,EACAuG,EAAAjF,IAAAA,MAAU5D,SAAS0I,EAAK7I,aAAaP,OAAMkJ,KAAIxJ,MAAA6J,EAAID,GAC/CA,EAAQtE,OAAS,KACnBoE,EAAKvI,QAAS,EAElB,IACC0D,MAAK,WACJ6E,EAAKzG,SAAU,EACff,EAAEyB,QACJ,GAEN,EAAC3B,EAEDqC,KAAA,WAAO,IAAAiG,EAAA,KACLnK,KAAK8C,SAAU,EACff,EAAEyB,SAEGiB,IAAAA,MAAU5D,WACb4D,IAAAA,MAAU5D,SAAW,IAGvBb,KAAKU,aAAaI,aAAa6G,KAAI,SAACf,GAC9BR,SAASQ,EAAUrG,OAAOJ,QAAUiG,SAAS3B,IAAAA,QAAYlE,KAAKJ,OAChEgK,EAAK5J,KAAOqG,EAAUrG,OACtB4J,EAAKvD,UAAYA,GAEjBuD,EAAKN,YAAcjD,CAEvB,IAEKnC,IAAAA,MAAU5D,SAASb,KAAKU,aAAaP,QACxCsE,IAAAA,MAAU5D,SAASb,KAAKU,aAAaP,MAAQ,IAG/CH,KAAKkF,aACP,EAACtC,CAAA,CAvYkC,CAASD,KCbT7D,OAAOC,KAAKC,OAAO,6BCIrB,IAEdoL,EAAY,SAAA7I,GAAA,SAAA6I,IAAA,OAAA7I,EAAA1B,MAAA,KAAAC,YAAA,KAAAR,EAAA8K,EAAA7I,GAAA,IAAAM,EAAAuI,EAAA5L,UAiD9B,OAjD8BqD,EAC/BgB,OAAA,SAAOZ,GAAO,IAAAC,EAAA,KACZlC,KAAKU,aAAeuB,EAAMR,MAAMf,aAChCV,KAAK8F,MAAQ7D,EAAMR,MAAMmG,EACzB5H,KAAKqK,OAASpI,EAAMR,MAAM4I,OAC1BrK,KAAK8C,SAAU,EACf9C,KAAK+C,OAASd,EAAMR,MAAMsB,OAC1B/C,KAAKU,aAAaI,aAAa6G,KAAI,SAACf,GAC9BR,SAASQ,EAAUrG,OAAOJ,QAAUiG,SAAS3B,IAAAA,QAAYlE,KAAKJ,QAChE+B,EAAK3B,KAAOqG,EAAUrG,OACtB2B,EAAKY,SAAU,EACff,EAAEyB,SAEN,IACAjC,EAAA/C,UAAMwD,SAAQtD,KAAC,KAAAuD,EACjB,EAACJ,EAEDY,SAAA,SAASR,GACPV,EAAA/C,UAAMiE,SAAQ/D,KAAC,KAAAuD,EACjB,EAACJ,EAEDG,SAAA,SAASC,GACPV,EAAA/C,UAAMwD,SAAQtD,KAAC,KAAAuD,EACjB,EAACJ,EAGD6G,QAAA,SAAQhD,GACN1F,KAAKsK,SAAU,EACftK,KAAKyB,MAAMiH,QAAQhD,GAGL6E,SAASC,iBAAiB,iBAClCC,SAAQ,SAAAC,GACRA,IAAShF,EAAEE,eACb8E,EAAKC,UAAUC,OAAO,SAE1B,GACF,EAAC/I,EAEDC,KAAA,SAAKG,GAAO,IAAA8C,EAAA,KACV,OAAI/E,KAAK8C,UAAY9C,KAAKO,KAAa,KAGnCwB,EAAA,MAAI5B,GAAIH,KAAK8F,MAAOpE,UAAW1B,KAAKsK,QAAU,sBAAwB,eAAgB5B,QAAS,SAAChD,GAAC,OAAKX,EAAK2D,QAAQhD,EAAE,GACnH3D,EAAA,OAAKL,UAAU,wBACZqF,IAAO/G,KAAKO,OAIvB,EAAC6J,CAAA,CAjD8B,CAASzH,KCN1C,MAAM,EAA+B7D,OAAOC,KAAKC,OAAO,2B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,2B,aCQnC6L,EAAsB,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAAjL,MAAA,KAAAC,YAAA,KAAAR,EAAAuL,EAAAC,GAAA,IAAAjJ,EAAAgJ,EAAArM,UAqExC,OArEwCqD,EACzCgB,OAAA,SAAOZ,GACL6I,EAAAtM,UAAMqE,OAAMnE,KAAC,KAAAuD,GAGbwC,IAAAA,MAAUsG,uBAAyB,KAEnC/K,KAAK2F,cAAgB3F,KAAKyB,MAAMkE,cAEhC3F,KAAKgL,SAAU,EAEfhL,KAAKmE,eAAiBC,IAAO,IACxBpE,KAAK2F,gBAAe3F,KAAK2F,cAAgB,GAChD,EAAC9D,EAEDoJ,MAAA,WACE,OAAOxG,IAAAA,WAAe0C,MAAM,oCAC9B,EAACtF,EAEDH,UAAA,WACE,MAAO,sCACT,EAACG,EAEDF,QAAA,WACE,MAAO,CACLI,EAAA,OAAKL,UAAU,cACXK,EAAA,WACEA,EAAA,OAAKmJ,MAAM,YACRzG,IAAAA,WAAe0C,MAAM,yCAA0C,CAACD,SAAUA,IAASlH,KAAKyB,MAAMlB,SAEjGwB,EAAA,OAAKL,UAAU,0BACbK,EAAA,OAAKL,UAAU,iCACbK,EAAA,YAAUlD,MAAOmB,KAAKmE,iBAAkBiE,QAASC,IAAS,QAASrI,KAAKmE,gBAC9DoE,YAAa9D,IAAAA,WAAe0C,MAAM,+CAClCqB,KAAK,MACdC,IAAAA,UAAiB,CACd0C,KAAM,SACNzJ,UAAW,yBACXiH,UAAW3I,KAAKmE,kBACfM,IAAAA,WAAe0C,MAAM,2CAOxC,EAACtF,EAEDuJ,SAAA,SAAS1F,GAAG,IAAAxD,EAAA,KACVwD,EAAE2F,iBACF,IAAMzE,EAAY5G,KAAKyB,MAAMlB,KAC7BkE,IAAAA,MAAUsG,uBAAyB,KACnCtG,IAAAA,MAAUyE,aAAa,iBACpBC,KAAK,CACJC,gBAAiBpJ,KAAKmE,iBACtByC,UAAWA,EAAUzG,OACpBuE,MAAK,SAAAhE,GACR,IAAKA,EAAaM,SAAU,CAC1BkB,EAAKyD,cAAc0D,KAAK3I,GACxB,IAAM4K,EAAU7G,IAAAA,QAAYlE,KAAKoF,gBAC7B2F,IACFA,EAAQjC,KAAK3I,GACb+D,IAAAA,QAAYlE,KAAKoF,cAAgBvB,IAAOkH,GAE5C,CACA7G,IAAAA,OAAW8G,KAAKC,IAAO,CAAEL,KAAM,WAAa1G,IAAAA,WAAe0C,MAAM,4CACjEpF,EAAEyB,SACFiB,IAAAA,MAAUgH,OACZ,GACF,EAACZ,CAAA,CArEwC,CAASa,KCD/BC,GAAiB,SAAApK,GAAA,SAAAoK,IAAA,OAAApK,EAAA1B,MAAA,KAAAC,YAAA,KAAAR,EAAAqM,EAAApK,GAAA,IAAAM,EAAA8J,EAAAnN,UA0HnC,OA1HmCqD,EACpCgB,OAAA,SAAOZ,GACLjC,KAAK+C,OAASd,EAAMR,MAAMsB,OAC1B/C,KAAKkE,OACLlE,KAAK8C,SAAU,EACf9C,KAAK4L,oBAAsB,IAC7B,EAAC/J,EAEDiD,SAAA,WAAY,EAACjD,EAEbyD,eAAA,WAAiB,IAAApD,EAAA,KACTsE,EAAOlC,EAAE,2BACfkC,EAAKhB,IAAI,UAAUC,GAAG,UAAU,WAC1BoG,OAAOC,YAAc,IAEnBtF,EAAKuF,aAAevF,EAAKsF,cAAgBtF,EAAK,GAAGwF,aACnD9J,EAAK+J,WAIHzF,EAAKhC,YAAcgC,EAAKE,eAAiBF,EAAK,GAAGG,cACnDzE,EAAK+J,UAGX,GACF,EAACpK,EAEDC,KAAA,WAAO,IAAAiD,EAAA,KACL,IAAI/E,KAAK8C,SACJ2B,IAAAA,MAAUkB,cAAf,CACA,IAAMA,EAAgBlB,IAAAA,MAAUkB,cAUhC,OARiC,OAA7B3F,KAAK4L,qBAAgCnH,IAAAA,MAAUkB,eAAiBlB,IAAAA,MAAUkB,cAAcR,OAAS,IACnGnF,KAAK4L,oBAAsBnH,IAAAA,MAAUkB,cAAc,IAGjD3F,KAAK4L,sBACP5L,KAAKkM,sBAAwBtJ,EAAiBuJ,UAAU,CAAEzL,aAAcV,KAAK4L,oBAAqB7I,OAAQ/C,KAAK+C,UAI/GhB,EAAA,OAAKL,UAAU,qBACbK,EAAA,OAAK+E,MAAOnB,EAAcR,OAAS,GAAK,+BAAgCzD,UAAU,sBAChFK,EAAA,OAAK+E,MAAO9G,KAAK+C,OAAS,gDAAkD,GAAIrB,UAAU,cAAcvB,GAAG,iBACtGwF,EAAcR,QACfpD,EAAA,MAAIL,UAAU,0BACX0K,MAAMC,QAAQ1G,IACbA,EAAcgC,KAAI,SAACjH,EAAckH,GAC/B,OACE7F,EAACqI,EAAY,CACX1J,aAAcA,EACdkH,EAAGA,EACHyC,QAAQtF,EAAKhC,QAAiBgC,EAAK6G,sBAAwBlL,EAC3DgI,QAAS,SAAChD,GACJX,EAAKhC,OACPhB,EAAEkB,MAAMwB,IAAAA,MAAU,WAAY,CAAEtE,GAAIsE,IAAAA,MAAUkB,cAAcrB,EAAEoB,EAAEE,eAAeC,KAAK,OAAO1F,SAE3F4E,EAAK6G,oBAAsBnH,IAAAA,MAAUkB,cAAcrB,EAAEoB,EAAEE,eAAeC,KAAK,OAC3E9D,EAAEyB,SAEN,GAGN,OAINxD,KAAK+C,QAAU/C,KAAKkM,uBAtCQ,CA0CtC,EAACrK,EAEDyK,UAAA,WACE7H,IAAAA,MAAU8G,KAAKV,EAAwB,CACrClF,cAAelB,IAAAA,MAAUkB,cACzB9E,SAAU4D,IAAAA,MAAU5D,UAExB,EAACgB,EAEDoK,SAAA,WAAW,IAAA1G,EAAA,KACTvF,KAAK8C,SAAU,EAGf2B,IAAAA,MACG+E,KAAK,wBAAyB,CAAEpE,OAAQX,IAAAA,MAAUkB,cAAcR,SAChET,MAAK,SAAC+E,UACEA,EAAQE,QACfF,EAAQ9B,KAAI,SAAC4E,GACX9H,IAAAA,MAAUkB,cAAc0D,KAAKkD,EAC/B,GACF,IAAE,OACK,WAAO,IACb7H,MAAK,WACJa,EAAKzC,SAAU,EACff,EAAEyB,QACJ,GACJ,EAAC3B,EAEDqC,KAAA,WAAO,IAAAiC,EAAA,KACD1B,IAAAA,MAAUkB,gBAAkB3F,KAAK+C,SAIjC/C,KAAK+C,SACP0B,IAAAA,MAAUkB,cAAgB,IAG5B3F,KAAK8C,SAAU,EACff,EAAEyB,SAEFiB,IAAAA,MACG+E,KAAK,yBACL9E,MAAK,SAAC+E,UACEA,EAAQE,QACflF,IAAAA,MAAUkB,cAAgB8D,CAC5B,IAAE,OACK,WAAO,IACb/E,MAAK,WACJyB,EAAKrD,SAAU,EACff,EAAEyB,QACJ,IACJ,EAACmI,CAAA,CA1HmC,CAAShJ,KCH1B6J,GAAiB,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAA5M,MAAA,KAAAC,YAAA,KAAAR,EAAAkN,EAAAC,GAAA,IAAA5K,EAAA2K,EAAAhO,UAenC,OAfmCqD,EACpCgB,OAAA,WACE4J,EAAAjO,UAAMqE,OAAMnE,KAAC,MAEb+F,IAAIiI,QAAQrD,KAAK,YAEjBrJ,KAAK2M,UAAY,oBACnB,EAAC9K,EAEDC,KAAA,WACE,OACEC,EAAA,OAAKL,UAAU,qBACbK,EAAC4J,GAAiB,CAAC5I,QAAQ,IAGjC,EAACyJ,CAAA,CAfmC,CAASI,KCA1BC,GAAoB,SAAAJ,GAAA,SAAAI,IAAA,OAAAJ,EAAA5M,MAAA,KAAAC,YAAA,KAAAR,EAAAuN,EAAAJ,GAAA,IAAA5K,EAAAgL,EAAArO,UA0BtC,OA1BsCqD,EACvCiL,KAAA,WAAO,IAAA5K,EAAA,KACLuK,EAAAjO,UAAMsO,KAAIpO,KAAC,MAEX+F,IAAIiI,QAAQrD,KAAK,iBAEjB,IAAMrG,EAAUjB,EAAEkB,MAAMC,MAAM,MAE9BuB,IAAIsI,MAAMvD,KAAK,wBAAyBxG,GAAS0B,MAAK,SAAChE,GACrD+D,IAAIuI,MAAMrH,cAAgB,GAC1BlB,IAAIuI,MAAMrH,cAAc0D,KAAK3I,GAC7BwB,EAAKsE,KAAO5D,EAAiBuJ,UAAU,CAAEzL,aAAAA,EAAcqC,QAAQ,IAC/DhB,EAAEyB,QACJ,IAEAxD,KAAK2M,UAAY,eACnB,EAAC9K,EAEDC,KAAA,WACE,OACEC,EAAA,OAAKL,UAAU,gBACbK,EAAA,OAAKL,UAAU,qBACbK,EAAA,OAAKL,UAAU,sBAAsB1B,KAAKwG,KAAOxG,KAAKwG,KAAO,OAIrE,EAACqG,CAAA,CA1BsC,CAASD,KCJlD,MAAM,GAA+B9N,OAAOC,KAAKC,OAAO,gB,eCAxD,MAAM,GAA+BF,OAAOC,KAAKC,OAAO,sB,eCAxD,MAAM,GAA+BF,OAAOC,KAAKC,OAAO,qB,eCAxD,MAAM,GAA+BF,OAAOC,KAAKC,OAAO,iBCAlD,GAA+BF,OAAOC,KAAKC,OAAO,oC,eCAxD,MAAM,GAA+BF,OAAOC,KAAKC,OAAO,0C,ICOnCiO,GAAqB,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAArN,MAAA,KAAAC,YAAA,KAAAR,EAAA2N,EAAAC,GAAA,IAAArL,EAAAoL,EAAAzO,UA8CvC,OA9CuCqD,EACxCgB,OAAA,SAAOZ,GACLiL,EAAA1O,UAAMqE,OAAMnE,KAAC,KAAAuD,GACbjC,KAAK0I,QAAU1I,KAAK0I,QAAQtJ,KAAKY,MACjCA,KAAKmN,QAAUnN,KAAKmN,QAAQ/N,KAAKY,MACjCA,KAAKoN,UAAYpN,KAAKoN,UAAUhO,KAAKY,KACvC,EAACiN,EAEMzL,UAAP,SAAiBC,GACfA,EAAM4L,QAAN5L,EAAM4L,MAAU5I,IAAAA,WAAe0C,MAAM,2CACrC1F,EAAMuG,OAANvG,EAAMuG,KAAS,cACfvG,EAAMC,UAAY,yCAElBwL,EAAM1L,UAAS9C,KAAC,KAAA+C,EAClB,EAACI,EAED6G,QAAA,WACMjE,IAAAA,OAAW6I,UACbtN,KAAKoN,WAET,EAACvL,EAEDsL,QAAA,WACE,OACIpL,EAAA,QAAML,UAAW,iBAAmB1B,KAAKyB,MAAM8L,iBAC1CvN,KAAKwN,SAAWzL,EAAC4J,GAAiB,CAAC5I,QAAQ,IAGtD,EAAClB,EAEDuL,UAAA,WACE,IAAMK,EAAqBhJ,IAAAA,MAAU,iBACrCiJ,QAAQC,MAAM,uBAAuBlJ,IAAAA,QACjCA,IAAAA,OAAagJ,EACf1L,EAAEkB,MAAMwK,GAERC,QAAQC,MAAM,iCAElB,EAAC9L,EAED+L,eAAA,WACE,OAAOnJ,IAAAA,QAAYlE,KAAKyJ,gBAC1B,EAACnI,EAEDgM,YAAA,WACE,OAAOpJ,IAAAA,QAAYlE,KAAKyJ,gBAC1B,EAACiD,CAAA,CA9CuC,C,OAASa,ICUnDrJ,IAAAA,aAAiBsJ,IAAI,mBAAmB,SAAUtJ,GAChDA,EAAIsI,MAAMiB,OAAOnN,SAAWlB,EAC5B8E,EAAIsI,MAAMiB,OAAOrI,cAAgB/E,EACjC6D,EAAIsI,MAAMiB,OAAOC,mBAAqB/M,EAEtCgN,IAAAA,UAAevI,cAAgBtF,IAAAA,QAAc,iBAC7C6N,IAAAA,UAAelE,eAAiB3J,IAAAA,UAAgB,kBAEhDoE,EAAI0J,OAAOxI,cAAgB,CAAEyI,KAAM,yBAA0BjC,UAAWK,IACxE/H,EAAI0J,OAAOtN,SAAW,CAAEuN,KAAM,wBAAyBjC,UAAWU,KCpBlEwB,EAAAA,GAAAA,QAAOC,KAAAA,UAA2B,SAAS,SAAUC,IAC/C9J,IAAAA,MAAUwB,UAAU,eAAkBxB,IAAAA,QAAYlE,MAAQkE,IAAAA,QAAYlE,KAAKoF,gBAAgBR,SAC7FoJ,EAAMR,IAAI,WAAYhM,EAACkL,GAAqB,MAAK,GAErD,KDqBAoB,EAAAA,EAAAA,QAAOG,IAAAA,UAAqB,YAAY,WAClC/J,EAAIgK,QACNhK,EAAIgK,OAAO/J,MAAK,SAACC,GACf,IAAMC,EAAWD,EAAOC,SACpBA,EAASrE,MACXqE,EAASrE,KAAKnB,KAAK,cAAc,SAACc,GAChCuE,EAAIiK,QAAQnO,KAAKyJ,eAAiB5F,KAAOK,EAAIiK,QAAQnO,KAAKyJ,iBAAmB,GAC7EjI,EAAEyB,QACJ,GAEJ,GAEJ,KAEA6K,EAAAA,EAAAA,QAAOG,IAAAA,UAAqB,YAAY,WAClC/J,EAAIgK,QACNhK,EAAIgK,OAAO/J,MAAK,SAACC,GACf,IAAMC,EAAWD,EAAOC,SACpBA,EAASrE,MACXqE,EAASrE,KAAKsE,OAAO,aAEzB,GAEJ,KACAwJ,EAAAA,EAAAA,QAAOM,KAAc,sBAAsB,SAACJ,EAAOhO,GAC7CkE,EAAImK,MAAM3I,UAAU,eACtBsI,EAAMR,IAAI,aAActF,KAAAA,UAAiB,CACvCT,KAAM,aACNU,QAAS,kBAAMjE,EAAIoK,MAAMtD,KAAKV,EAAwB,CAACtK,KAAAA,GAAM,GAC5DkE,EAAIqK,WAAW3H,MAAM,yCAE5B,GACF,G","sources":["webpack://@nodeloc/whisper/webpack/bootstrap","webpack://@nodeloc/whisper/webpack/runtime/compat get default export","webpack://@nodeloc/whisper/webpack/runtime/define property getters","webpack://@nodeloc/whisper/webpack/runtime/hasOwnProperty shorthand","webpack://@nodeloc/whisper/webpack/runtime/make namespace object","webpack://@nodeloc/whisper/external root \"flarum.core.compat['app']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['extend']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['components/IndexPage']\"","webpack://@nodeloc/whisper/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@nodeloc/whisper/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/Model']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/mixin']\"","webpack://@nodeloc/whisper/./src/forum/models/Message.js","webpack://@nodeloc/whisper/./src/forum/models/Conversation.js","webpack://@nodeloc/whisper/./src/forum/models/ConversationUser.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['models/User']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['Model']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/components/Page']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/components/Button']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/Component']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@nodeloc/whisper/./src/forum/components/MessageText.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/withAttr']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['forum/app']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['components/Link']\"","webpack://@nodeloc/whisper/./src/forum/components/ConversationView.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/userOnline']\"","webpack://@nodeloc/whisper/./src/forum/components/UserListItem.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/components/Alert']\"","webpack://@nodeloc/whisper/./src/forum/components/StartConversationModal.js","webpack://@nodeloc/whisper/./src/forum/components/ConversationsList.js","webpack://@nodeloc/whisper/./src/forum/components/ConversationsPage.js","webpack://@nodeloc/whisper/./src/forum/components/ConversationViewPage.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['utils/Stream']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['utils/UserControls']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['components/Button']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/extend']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['forum/components/HeaderSecondary']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['forum/components/NotificationsDropdown']\"","webpack://@nodeloc/whisper/./src/forum/components/ConversationsDropdown.js","webpack://@nodeloc/whisper/./src/forum/index.js","webpack://@nodeloc/whisper/./src/forum/addConversationsDropdown.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/IndexPage'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/mixin'];","import Model from 'flarum/common/Model';\nimport mixin from 'flarum/common/utils/mixin';\n\nexport default class Message extends mixin(Model, {\n  message: Model.attribute('message'),\n  user: Model.hasOne('user'),\n  isHidden: Model.attribute('isHidden'),\n  createdAt: Model.attribute('createdAt', Model.transformDate),\n  conversation: Model.hasOne('conversation'),\n  number: Model.hasOne('number'),\n}) {\n  apiEndpoint() {\n    return `/whisper/messages${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\nimport mixin from 'flarum/common/utils/mixin';\n\nexport default class Conversation extends mixin(Model, {\n  messages: Model.hasMany('messages'),\n  recipients: Model.hasMany('recipients'),\n  totalMessages: Model.attribute('totalMessages'),\n  notNew: Model.attribute('notNew'),\n  createdAt: Model.attribute('createdAt', Model.transformDate),\n  updatedAt: Model.attribute('updatedAt', Model.transformDate),\n}) {\n  apiEndpoint() {\n    return `/whisper/conversations${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\nimport mixin from 'flarum/common/utils/mixin';\n\nexport default class ConversationUser extends mixin(Model, {\n  conversation: Model.hasOne('conversation'),\n  user: Model.hasOne('user'),\n\n  userId: Model.attribute('userId'),\n  conversationId: Model.attribute('conversationId'),\n  lastRead: Model.attribute('lastRead'),\n}) {}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/humanTime'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","import Component from 'flarum/common/Component';\n\nexport default class MessageText extends Component {\n  static initAttrs(attrs) {\n    attrs.className = attrs.className || '';\n    attrs.content = attrs.content || '';\n    attrs.preview = attrs.preview || false;\n  }\n\n  view() {\n    return <div className={this.attrs.className} />;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    if (this.attrs.preview) {\n      let preview;\n      const updatePreview = () => {\n        const content = this.attrs.content;\n\n        if (preview === content) return;\n\n        preview = content;\n\n        s9e.TextFormatter.preview(content || '', vnode.dom);\n      };\n      updatePreview();\n\n      this.updateInterval = setInterval(updatePreview, 50);\n    } else {\n      s9e.TextFormatter.preview(this.attrs.content, vnode.dom);\n    }\n  }\n\n  onremove() {\n    clearInterval(this.updateInterval);\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/withAttr'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/Link'];","import Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport MessageText from './MessageText';\nimport Stream from 'flarum/common/utils/Stream';\nimport withAttr from 'flarum/common/utils/withAttr';\nimport icon from 'flarum/common/helpers/icon';\nimport app from 'flarum/forum/app';\nimport Link from \"flarum/components/Link\";\n\nexport default class ConversationView extends Component {\n  oninit(vnode) {\n    this.loading = true;\n    this.vnode = vnode;\n    this.mobile = vnode.attrs.mobile;\n    this.idParam = m.route.param('id');\n    this.firstLoad = true;\n\n    this.typingTimeout = true;\n\n    this.sendTimeout = true;\n\n    const interval1 = () => {\n      this.typingTimeout = true;\n      setTimeout(() => {\n        interval1();\n      }, 5000);\n    };\n\n    const interval2 = () => {\n      if (this.typingTime < new Date(Date.now() - 6000)) {\n        this.typing = false;\n        m.redraw();\n      }\n      setTimeout(() => {\n        interval2();\n      }, 6000);\n    };\n\n    this.interval3 = () => {\n      if (this.timer === 0) {\n        this.sendTimeout = true;\n        m.redraw();\n        return;\n      }\n      this.timer--;\n      if (this.timer >= 0) {\n        setTimeout(() => {\n          this.interval3();\n        }, 1000);\n      }\n    };\n\n    interval1();\n    interval2();\n\n    this.typing = false;\n\n    this.conversation = this.conversation ? this.conversation : vnode.attrs.conversation;\n\n    this.initPost();\n  }\n\n  initPost() {\n    this.newMessageCount = 0;\n\n    this.load();\n\n    this.messageContent = Stream('');\n\n    return new Promise(() => {\n      setTimeout(() => {\n        $('.chat-history').animate({ scrollTop: $('.chat-history').prop('scrollHeight') }, 1000);\n      }, 500);\n    });\n  }\n\n  onremove() {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        channels.user.unbind('typing');\n        channels.user.unbind('newMessage');\n      });\n    }\n  }\n\n  onupdate() {\n    $('.chat-history').scroll(() => {\n      if (!this.notNew) {\n        let pos = $('.chat-history').scrollTop();\n        if (pos === 0) {\n          const firstMsg = $('.message-content:first');\n          this.getMessages(app.cache.messages[this.conversation.id()].length);\n          if (!this.notNew) {\n            $('.chat-history').scrollTop(firstMsg.offset().top);\n          }\n        }\n      }\n    });\n  }\n\n  onbeforeupdate() {\n    $('.UserListItem')\n      .off('click')\n      .on('click', (e) => {\n        this.conversation = app.cache.conversations[$(e.currentTarget).attr('id')];\n        this.index = $(e.currentTarget).attr('id');\n        this.notNew = false;\n        this.cipher = null;\n        this.oninit(this.vnode);\n        m.redraw();\n      });\n\n    $('#MessageTextArea')\n      .off()\n      .on('keydown', (e) => {\n        if (e.keyCode === 13 && app.forum.attribute('whisperReturnKey')) {\n          $('#MessageTextArea').prop('disabled', true);\n          this.sendMessage();\n        }\n      });\n  }\n\n  oncreate() {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        channels.user.bind('newMessage', (data) => {\n          if (\n            parseInt(data.conversationId) === parseInt(this.conversation.id()) &&\n            $('.MessagesDropdown').children('.Dropdown-menu').is(':visible')\n          ) {\n            const message = {\n              id: Stream(data.id),\n              message: Stream(data.message),\n              user: Stream(this.user),\n              createdAt: Stream(data.createdAt),\n            };\n            this.decryptMessages([message]);\n            this.newMessageCount++;\n            this.typing = false;\n            m.redraw();\n            $('.chat-history').animate({ scrollTop: $('.chat-history').prop('scrollHeight') }, 1000);\n          }\n        });\n\n        channels.user.bind('typing', (data) => {\n          if (parseInt(data.conversationId) === parseInt(this.conversation.id())) {\n            let list = $('.chat-history');\n\n            let scrollMore = false;\n\n            if (list.scrollTop() + list.innerHeight() >= list[0].scrollHeight - 50) {\n              scrollMore = true;\n            }\n\n            this.typing = true;\n            this.typingTime = new Date();\n            m.redraw();\n\n            if (scrollMore) {\n              list.animate({ scrollTop: $('.chat-history').prop('scrollHeight') }, 400);\n            }\n          }\n        });\n\n        channels.user.bind('readMessage', (data) => {\n          if (parseInt(data.conversationId) === parseInt(this.conversation.id())) {\n            this.recipient.lastRead = m.prop(data.number);\n            m.redraw();\n          }\n        });\n      });\n    }\n  }\n\n  view() {\n    this.messages = app.cache.messages ? app.cache.messages[this.conversation.id()] : [];\n    return (\n      <div style={this.idParam && this.mobile ? 'width: 100%' : ''} className=\"chat\">\n        <div className=\"chat-header clearfix\">\n          {avatar(this.user)}\n          <div className=\"chat-about\">\n            <div className=\"chat-with\">\n            <Link href={app.route.user(this.user)}>\n            {username(this.user)}\n            </Link>\n            </div>\n            <div className=\"chat-num-messages\">\n              {app.translator.trans(\n                'nodeloc-whisper.forum.chat.messages_' + (parseInt(this.conversation.totalMessages()) > 1 ? 'multiple' : 'single'),\n                { count: this.conversation.totalMessages() + this.newMessageCount }\n              )}\n            </div>\n          </div>\n        </div>\n        {this.messages && this.messages.length > 0 && !this.loading ? (\n          [\n            <div className=\"chat-history\">\n              <ul>\n                {this.notNew ? <li className=\"startConvo\">{app.translator.trans('nodeloc-whisper.forum.chat.start_of_conversation')}</li> : ''}\n                {this.messages\n                  ? this.messages\n                      .filter((message, index, self) => index === self.findIndex((t) => t.message() === message.message()))\n                      .sort((a, b) => {\n                        return a.createdAt() - b.createdAt();\n                      })\n                      .map((message, i) => {\n                        const myMessage = parseInt(message.user().id()) === parseInt(app.session.user.id());\n                        return (\n                          <li className=\"clearfix message-content\">\n                            <div className={'message-data ' + (myMessage ? 'align-right' : '')}>\n                              <div className={'avatar-inline ' + (myMessage ? 'me' : 'other')}>\n                                {avatar(myMessage ? app.session.user : message.user())}\n                              </div>\n                              <span className=\"message-data-name\">{username(myMessage ? app.session.user : message.user())}</span>\n                              <span className=\"message-data-time\">{humanTime(message.createdAt())}</span>\n                            </div>\n                            <MessageText\n                              content={message.message()}\n                              className={'message ' + (myMessage ? 'my-message float-right' : 'other-message')}\n                            />\n                            {myMessage ? (\n                              parseInt(this.recipient.lastRead()) >= parseInt(message.data.attributes.number) ? (\n                                <span className=\"message-read\">{icon('fas fa-check')}</span>\n                              ) : (\n                                ''\n                              )\n                            ) : (\n                              ''\n                            )}\n                          </li>\n                        );\n                      })\n                  : ''}\n                {this.messageContent() ? (\n                  <li>\n                    <MessageText content={this.messageContent()} className={'message my-message float-right message-preview'} preview={true} />\n                  </li>\n                ) : (\n                  ''\n                )}\n                {this.typing ? (\n                  <li>\n                    <div className=\"tiblock\">\n                      <div className=\"tidot\"></div>\n                      <div className=\"tidot\"></div>\n                      <div className=\"tidot\"></div>\n                    </div>\n                  </li>\n                ) : (\n                  ''\n                )}\n              </ul>\n            </div>,\n          ]\n        ) : (\n          <LoadingIndicator display=\"block\" size=\"medium\" />\n        )}\n\n        <form className=\"chat-message clearfix\">\n          <textarea\n            id=\"MessageTextArea\"\n            value={this.messageContent()}\n            oninput={withAttr('value', this.typingPush.bind(this))}\n            placeholder={app.translator.trans('nodeloc-whisper.forum.chat.text_placeholder')}\n            rows=\"3\"\n          ></textarea>\n\n          {Button.component(\n            {\n              onclick: this.sendMessage.bind(this),\n              className: 'Button Button--primary',\n              disabled: !this.messageContent() || !this.sendTimeout,\n            },\n            app.translator.trans('nodeloc-whisper.forum.chat.send')\n          )}\n        </form>\n      </div>\n    );\n  }\n\n  typingPush(value) {\n    this.messageContent(value);\n    m.redraw();\n    if (this.typingTimeout) {\n      app\n        .request({\n          method: 'POST',\n          url: app.forum.attribute('apiUrl') + '/whisper/messages/typing',\n          body: {\n            conversationId: this.conversation.id(),\n            userId: this.user.id(),\n          },\n        })\n        .then(() => {\n          this.typingTimeout = false;\n        });\n    }\n  }\n\n  sendMessage() {\n    if (this.sendTimeout) {\n      if (this.messageContent() === '' || !this.messageContent().replace(/\\s/g, '').length) return;\n      this.sendTimeout = false;\n      this.timer = 1;\n      this.interval3();\n      this.newMessageCount++;\n      app.store\n        .createRecord('messages')\n        .save({\n          messageContents: this.messageContent(),\n          conversationId: this.conversation.id(),\n        })\n        .then((message) => {\n          app.cache.messages[this.conversation.id()].push(message);\n          m.redraw();\n          this.messageContent('');\n          $('.chat-history').animate({ scrollTop: $('.chat-history').prop('scrollHeight') }, 500);\n          app.request({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/whisper/messages/read',\n            body: {\n              conversationId: this.conversation.id(),\n              messageId: message.id(),\n            },\n          });\n        });\n    }\n  }\n\n  getMessages(offset = 0) {\n    if (!this.notNew) {\n      app.store\n        .find('whisper/messages', this.conversation.id(), { offset })\n        .then((results) => {\n          delete results.payload;\n          if (this.firstLoad) {\n            const oldNumber = this.meRecipient.lastRead();\n            app\n              .request({\n                method: 'POST',\n                url: app.forum.attribute('apiUrl') + '/whisper/messages/read',\n                body: {\n                  conversationId: this.conversation.id(),\n                  messageId: results[0].id(),\n                },\n              })\n              .then((response) => {\n                const newNumber = response.data.attributes.lastRead;\n                let unreadMessages = 0;\n                const lastUnreadMessage = app.session.user.unreadMessages();\n\n                if (lastUnreadMessage !== 0) unreadMessages = lastUnreadMessage - (newNumber - oldNumber);\n\n                if (unreadMessages >= 0) {\n                  app.session.user.pushAttributes({\n                    unreadMessages,\n                  });\n\n                  m.redraw();\n                }\n\n                this.firstLoad = false;\n              });\n          }\n          app.cache.messages[this.conversation.id()].push(...results);\n          if (results.length < 20) {\n            this.notNew = true;\n          }\n        })\n        .then(() => {\n          this.loading = false;\n          m.redraw();\n        });\n    }\n  }\n\n  load() {\n    this.loading = true;\n    m.redraw();\n\n    if (!app.cache.messages) {\n      app.cache.messages = [];\n    }\n\n    this.conversation.recipients().map((recipient) => {\n      if (parseInt(recipient.user().id()) !== parseInt(app.session.user.id())) {\n        this.user = recipient.user();\n        this.recipient = recipient;\n      } else {\n        this.meRecipient = recipient;\n      }\n    });\n\n    if (!app.cache.messages[this.conversation.id()]) {\n      app.cache.messages[this.conversation.id()] = [];\n    }\n\n    this.getMessages();\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/userOnline'];","import Component from 'flarum/common/Component';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport userOnline from 'flarum/common/helpers/userOnline';\nimport app from 'flarum/forum/app';\n\nexport default class UserListItem extends Component {\n  oninit(vnode) {\n    this.conversation = vnode.attrs.conversation;\n    this.index = vnode.attrs.i;\n    this.active = vnode.attrs.active;\n    this.loading = true;\n    this.mobile = vnode.attrs.mobile;\n    this.conversation.recipients().map((recipient) => {\n      if (parseInt(recipient.user().id()) !== parseInt(app.session.user.id())) {\n        this.user = recipient.user();\n        this.loading = false;\n        m.redraw();\n      }\n    });\n    super.oncreate(vnode);\n  }\n\n  onremove(vnode) {\n    super.onremove(vnode);\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n  }\n\n\n  onclick(e) {\n    this.clicked = true; // Set the flag to true when the item is clicked\n    this.attrs.onclick(e); // Call the original onclick handler\n\n    // Remove 'active' class from other items\n    const items = document.querySelectorAll('.UserListItem');\n    items.forEach(item => {\n      if (item !== e.currentTarget) {\n        item.classList.remove('active');\n      }\n    });\n  }\n\n  view(vnode) {\n    if (this.loading || !this.user) return null;\n\n    return (\n        <li id={this.index} className={this.clicked ? 'UserListItem active' : 'UserListItem'} onclick={(e) => this.onclick(e)}>\n          <div className=\"UserListItem-content\">\n            {avatar(this.user)}\n          </div>\n        </li>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Alert'];","import Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport Alert from 'flarum/common/components/Alert';\nimport username from 'flarum/common/helpers/username';\nimport Stream from 'flarum/common/utils/Stream';\nimport withAttr from 'flarum/common/utils/withAttr';\nimport app from 'flarum/forum/app';\n\nexport default class StartConversationModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n\n    app.cache.conversationsRecipient = null;\n\n    this.conversations = this.attrs.conversations;\n\n    this.already = false;\n\n    this.messageContent = Stream('');\n    if (!this.conversations) this.conversations = [];\n  }\n\n  title() {\n    return app.translator.trans('nodeloc-whisper.forum.modal.title');\n  }\n\n  className() {\n    return 'StartConversationModal Modal--medium';\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n          <div>\n            <div class=\"helpText\">\n              {app.translator.trans('nodeloc-whisper.forum.modal.help_start', {username: username(this.attrs.user)})}\n            </div>\n            <div className=\"AddRecipientModal-form\">\n              <div className=\"AddRecipientModal-form-submit\">\n                <textarea value={this.messageContent()} oninput={withAttr('value', this.messageContent)}\n                          placeholder={app.translator.trans('nodeloc-whisper.forum.chat.text_placeholder')}\n                          rows=\"3\"></textarea>\n                {Button.component({\n                    type: 'submit',\n                    className: 'Button Button--primary',\n                    disabled: !this.messageContent(),\n                  }, app.translator.trans('nodeloc-whisper.forum.modal.submit')\n                )}\n              </div>\n            </div>\n          </div>\n      </div>\n    ];\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n    const recipient = this.attrs.user;\n    app.cache.conversationsRecipient = null;\n    app.store.createRecord('conversations')\n      .save({\n        messageContents: this.messageContent(),\n        recipient: recipient.id(),\n      }).then(conversation => {\n      if (!conversation.notNew()) {\n        this.conversations.push(conversation);\n        const preconv = app.session.user.conversations();\n        if (preconv) {\n          preconv.push(conversation);\n          app.session.user.conversations = Stream(preconv);\n        }\n      }\n      app.alerts.show(Alert, { type: 'success' }, app.translator.trans('nodeloc-whisper.forum.chat.send_success'));\n      m.redraw();\n      app.modal.close();\n    })\n  }\n}\n","import Button from 'flarum/common/components/Button';\nimport Component from 'flarum/common/Component';\nimport ConversationView from './ConversationView';\nimport UserListItem from './UserListItem';\nimport StartConversationModal from './StartConversationModal';\nimport app from 'flarum/forum/app';\n\nexport default class ConversationsList extends Component {\n  oninit(vnode) {\n    this.mobile = vnode.attrs.mobile;\n    this.load();\n    this.loading = false;\n    this.currentConversation = null;\n  }\n\n  onupdate() {}\n\n  onbeforeupdate() {\n    const list = $('.ConversationsList-list');\n    list.off('scroll').on('scroll', () => {\n      if (window.innerWidth <= 768) {\n        // 移动端左右滑动检测\n        if (list.scrollLeft() + list.innerWidth() >= list[0].scrollWidth) {\n          this.loadMore();\n        }\n      } else {\n        // 桌面端上下滚动检测\n        if (list.scrollTop() + list.innerHeight() >= list[0].scrollHeight) {\n          this.loadMore();\n        }\n      }\n    });\n  }\n\n  view() {\n    if (this.loading) return;\n    if (!app.cache.conversations) return;\n    const conversations = app.cache.conversations;\n\n    if (this.currentConversation === null && app.cache.conversations && app.cache.conversations.length > 0) {\n      this.currentConversation = app.cache.conversations[0];\n    }\n\n    if (this.currentConversation) {\n      this.conversationComponent = ConversationView.component({ conversation: this.currentConversation, mobile: this.mobile });\n    }\n\n    return (\n      <div className=\"ConversationsList\">\n        <div style={conversations.length ? '' : 'width: unset; padding: 10px;'} className=\"container clearfix\">\n          <div style={this.mobile ? 'float: unset; margin: 0 auto; display: block;' : ''} className=\"people-list\" id=\"people-list\">\n            {!!conversations.length && (\n              <ul className=\"ConversationsList-list\">\n                {Array.isArray(conversations) &&\n                  conversations.map((conversation, i) => {\n                    return (\n                      <UserListItem\n                        conversation={conversation}\n                        i={i}\n                        active={this.mobile ? false : this.currentConversation === conversation}\n                        onclick={(e) => {\n                          if (this.mobile) {\n                            m.route(app.route('messages', { id: app.cache.conversations[$(e.currentTarget).attr('id')].id() }));\n                          } else {\n                            this.currentConversation = app.cache.conversations[$(e.currentTarget).attr('id')];\n                            m.redraw();\n                          }\n                        }}\n                      />\n                    );\n                  })}\n              </ul>\n            )}\n          </div>\n          {!this.mobile && this.conversationComponent}\n        </div>\n      </div>\n    );\n  }\n\n  showModal() {\n    app.modal.show(StartConversationModal, {\n      conversations: app.cache.conversations,\n      messages: app.cache.messages,\n    });\n  }\n\n  loadMore() {\n    this.loading = true;\n    //m.redraw();\n\n    app.store\n      .find('whisper/conversations', { offset: app.cache.conversations.length })\n      .then((results) => {\n        delete results.payload;\n        results.map((result) => {\n          app.cache.conversations.push(result);\n        });\n      })\n      .catch(() => {})\n      .then(() => {\n        this.loading = false;\n        m.redraw();\n      });\n  }\n\n  load() {\n    if (app.cache.conversations && !this.mobile) {\n      return;\n    }\n\n    if (this.mobile) {\n      app.cache.conversations = [];\n    }\n\n    this.loading = true;\n    m.redraw();\n\n    app.store\n      .find('whisper/conversations')\n      .then((results) => {\n        delete results.payload;\n        app.cache.conversations = results;\n      })\n      .catch(() => {})\n      .then(() => {\n        this.loading = false;\n        m.redraw();\n      });\n  }\n}\n","import Page from 'flarum/common/components/Page';\n\nimport ConversationsList from './ConversationsList';\n\nexport default class ConversationsPage extends Page {\n  oninit() {\n    super.oninit();\n\n    app.history.push('messages');\n\n    this.bodyClass = 'App--conversations';\n  }\n\n  view() {\n    return (\n      <div className=\"ConversationsPage\">\n        <ConversationsList mobile={true}></ConversationsList>\n      </div>\n    );\n  }\n}\n","import Page from 'flarum/common/components/Page';\n\nimport ConversationView from './ConversationView';\n\nexport default class ConversationViewPage extends Page {\n  init() {\n    super.init();\n\n    app.history.push('conversations');\n\n    const idParam = m.route.param('id');\n\n    app.store.find('whisper/conversations', idParam).then((conversation) => {\n      app.cache.conversations = [];\n      app.cache.conversations.push(conversation);\n      this.list = ConversationView.component({ conversation, mobile: true });\n      m.redraw();\n    });\n\n    this.bodyClass = 'App--messages';\n  }\n\n  view() {\n    return (\n      <div className=\"MessagesPage\">\n        <div className=\"ConversationsList\">\n          <div className=\"container clearfix\">{this.list ? this.list : null}</div>\n        </div>\n      </div>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['utils/UserControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/HeaderSecondary'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/NotificationsDropdown'];","import app from 'flarum/forum/app';\nimport NotificationsDropdown from 'flarum/forum/components/NotificationsDropdown';\n\nimport ConversationsList from './ConversationsList';\nimport ConversationsPage from \"./ConversationsPage\";\nimport ConversationViewPage from \"./ConversationViewPage\";\n\nexport default class ConversationsDropdown extends NotificationsDropdown {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.onclick = this.onclick.bind(this);\n    this.getMenu = this.getMenu.bind(this);\n    this.goToRoute = this.goToRoute.bind(this);\n  }\n\n  static initAttrs(attrs) {\n    attrs.label ||= app.translator.trans('nodeloc-whisper.forum.dropdown.tooltip');\n    attrs.icon ||= 'fas fa-sms';\n    attrs.className = 'MessagesDropdown NotificationsDropdown';\n\n    super.initAttrs(attrs);\n  }\n\n  onclick() {\n    if (app.drawer.isOpen()) {\n      this.goToRoute();\n    }\n  }\n\n  getMenu() {\n    return (\n        <form className={'Dropdown-menu ' + this.attrs.menuClassName}>\n          {!!this.showing && <ConversationsList mobile={false}/>}\n        </form>\n    );\n  }\n\n  goToRoute() {\n    const conversationsRoute = app.route('conversations');\n    console.error('Conversations route:',app.routes);\n    if (app.route && conversationsRoute) {\n      m.route(conversationsRoute);\n    } else {\n      console.error('Conversations route not found!');\n    }\n  }\n\n  getUnreadCount() {\n    return app.session.user.unreadMessages();\n  }\n\n  getNewCount() {\n    return app.session.user.unreadMessages();\n  }\n}\n","import app from 'flarum/app';\nimport {extend} from 'flarum/extend';\nimport IndexPage from 'flarum/components/IndexPage';\nimport Message from './models/Message';\nimport Conversation from './models/Conversation';\nimport ConversationUser from './models/ConversationUser';\nimport User from 'flarum/models/User';\nimport Model from 'flarum/Model';\nimport ConversationsPage from './components/ConversationsPage';\nimport ConversationViewPage from './components/ConversationViewPage';\nimport Stream from 'flarum/utils/Stream';\nimport UserControls from 'flarum/utils/UserControls';\nimport Button from 'flarum/components/Button';\n\nimport addConversationsDropdown from './addConversationsDropdown'\nimport StartConversationModal from \"./components/StartConversationModal\";\n\napp.initializers.add('nodeloc-whisper', function (app) {\n  app.store.models.messages = Message;\n  app.store.models.conversations = Conversation;\n  app.store.models.conversation_users = ConversationUser;\n\n  User.prototype.conversations = Model.hasMany('conversations');\n  User.prototype.unreadMessages = Model.attribute('unreadMessages');\n\n  app.routes.conversations = { path: '/whisper/conversations', component: ConversationsPage };\n  app.routes.messages = { path: '/whisper/messages/:id', component: ConversationViewPage };\n// 构建路由对象\n\n  addConversationsDropdown();\n\n  extend(IndexPage.prototype, 'oncreate', function () {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        if (channels.user) {\n          channels.user.bind('newMessage', (data) => {\n            app.session.user.unreadMessages = Stream(app.session.user.unreadMessages() + 1);\n            m.redraw();\n          });\n        }\n      });\n    }\n  });\n\n  extend(IndexPage.prototype, 'onremove', function () {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        if (channels.user) {\n          channels.user.unbind('newMessage');\n        }\n      });\n    }\n  })\n  extend(UserControls, 'moderationControls', (items, user) => {\n    if (app.forum.attribute('canMessage')) {\n      items.add('newMessage', Button.component({\n        icon: 'fas fa-sms',\n        onclick: () => app.modal.show(StartConversationModal, {user})\n      }, app.translator.trans('nodeloc-whisper.forum.chat.chat_with')));\n    }\n  });\n});\n","import { extend } from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport HeaderSecondary from 'flarum/forum/components/HeaderSecondary';\nimport ConversationsDropdown from './components/ConversationsDropdown';\n\nexport default function () {\n  extend(HeaderSecondary.prototype, 'items', function (items) {\n    if (app.forum.attribute('canMessage') || (app.session.user && app.session.user.conversations().length)) {\n      items.add('Messages', <ConversationsDropdown />, 20);\n    }\n  });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Message","_mixin","apply","arguments","apiEndpoint","this","exists","data","id","mixin","Model","message","user","isHidden","createdAt","conversation","number","Conversation","messages","recipients","totalMessages","notNew","updatedAt","ConversationUser","userId","conversationId","lastRead","MessageText","_Component","initAttrs","attrs","className","content","preview","_proto","view","m","oncreate","vnode","_this","updatePreview","s9e","TextFormatter","dom","updateInterval","setInterval","onremove","clearInterval","Component","ConversationView","oninit","loading","mobile","idParam","route","param","firstLoad","typingTimeout","sendTimeout","interval3","timer","redraw","setTimeout","interval1","interval2","typingTime","Date","now","typing","initPost","newMessageCount","load","messageContent","Stream","Promise","$","animate","scrollTop","app","then","object","channels","unbind","onupdate","_this2","scroll","firstMsg","getMessages","length","offset","top","onbeforeupdate","_this3","off","on","e","conversations","currentTarget","attr","index","cipher","keyCode","attribute","sendMessage","_this4","parseInt","children","is","decryptMessages","list","scrollMore","innerHeight","scrollHeight","recipient","_this5","style","avatar","Link","href","username","trans","count","filter","self","findIndex","t","sort","b","map","i","myMessage","humanTime","attributes","icon","LoadingIndicator","display","size","oninput","withAttr","typingPush","placeholder","rows","Button","onclick","disabled","_this6","method","url","body","_this7","replace","createRecord","save","messageContents","push","messageId","_this8","find","results","_app$cache$messages$_","payload","oldNumber","meRecipient","response","newNumber","unreadMessages","lastUnreadMessage","pushAttributes","_this9","UserListItem","active","clicked","document","querySelectorAll","forEach","item","classList","remove","StartConversationModal","_Modal","conversationsRecipient","already","title","class","type","onsubmit","preventDefault","preconv","show","Alert","close","Modal","ConversationsList","currentConversation","window","innerWidth","scrollLeft","scrollWidth","loadMore","conversationComponent","component","Array","isArray","showModal","result","ConversationsPage","_Page","history","bodyClass","Page","ConversationViewPage","init","store","cache","ConversationsDropdown","_NotificationsDropdow","getMenu","goToRoute","label","isOpen","menuClassName","showing","conversationsRoute","console","error","getUnreadCount","getNewCount","NotificationsDropdown","add","models","conversation_users","User","routes","path","extend","HeaderSecondary","items","IndexPage","pusher","session","UserControls","forum","modal","translator"],"sourceRoot":""}